<!DOCTYPE html>
<html lang="german">

<head>
  <!-- Required meta tags always come first -->
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <title>NumericalStats: Markov Chain Monte Carlo in 2 dimensions | HealthyNumerics
</title>
  <link rel="canonical" href="http://localhost:8000/posts/two-dimensional-markov-chain_monte-carlo-python.html">


  <link rel="apple-touch-icon" href="http://localhost:8000/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" type="image/png" href="http://localhost:8000/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="http://localhost:8000/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="http://localhost:8000/manifest.json">
  <meta name="theme-color" content="#333333">

  <link rel="stylesheet" href="http://localhost:8000/theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="http://localhost:8000/theme/css/font-awesome.min.css">
  <link rel="stylesheet" href="http://localhost:8000/theme/css/pygments/default.min.css">
  <link rel="stylesheet" href="http://localhost:8000/theme/css/style.css">
 

<meta name="description" content="Stochastic modeling is a commonly used methodology in health economics and outcomes research. We provide an insight in Markov Chain Monte Carlo modelling by a health related topic, the distribution of pollutants.">
<!-- base href="http://localhost:8000/output/images" / -->
<!-- base href="http://localhost:8000/" -->
<!--base href="/" / -->
</head>

<body>



       <!-- 
	   <div class="container-fluid"> <img class="img-fluid" src= "h01.jpg"> </div>
	   <div style="background-image: url(http://localhost:8000/siteImages/b04.jpg) </div>
	   <style> body { background: #ffffff url("http://localhost:8000/images/b04.jpg") no-repeat center top; } </style>	 
	   <body background="bgimage.jpg">	   
	   body { background-image: url("img_tree.gif"), url("img_flwr.gif");
              background-color: #cccccc;
              }
	   -->

	  

  <header class="header">
    <div class="container">
      <div class="row">
	  
        <style> body { background: #ffffff 
		               url(http://localhost:8000/siteImages/b04.jpg) no-repeat center top; }
		</style>
		<p class="text-hide"> .</p> <p class="text-hide"> .</p>
		<p class="text-hide"> .</p> <p class="text-hide"> .</p> <p class="text-hide"> .</p>
        <!--img  src="http://localhost:8000/siteImages/b04.jpg"-->		
  
		
        <div class="col-sm-4">
          <a href="http://localhost:8000">
            <img class="img-fluid" src=http://localhost:8000/siteImages/profile.png alt="HealthyNumerics">
          </a>
        </div>
        <div class="col-sm-8">
		
      
		  <h1 class="title"   > <a style=" color:white" href="http://localhost:8000">HealthyNumerics</a> </h1>
		  
		  
		  <p style="color:white; font-size:16pt;"  > HealthPoliticsEconomics  |  Quant Analytics  |  Numerics </p>

		  
          <ul class="list-inline">
            <li class="list-inline-item"><a style="color:#ccccff;" href="http://derProjektor.ch/" target="_blank">der Projektor</a></li>
			<li class="list-inline-item text-muted">|</li>
            <li class="list-inline-item"><a style="color:#ccccff;" href="http://HSPF.ch/" target="_blank">Health Systems</a></li>
			<li class="list-inline-item text-muted">|</li>
			
			

		
			
            <li class="list-inline-item"><a class="fa fa-linkedin" style=" color:white;"   href="https://ch.linkedin.com/in/peter-schuhmacher-8aa90a4b/en" target="_blank"></a></li>
            <li class="list-inline-item text-muted">|</li>

		
			
            <li class="list-inline-item"><a class="fa fa-twitter" style=" color:white;"   href="https://twitter.com/PeSchuh" target="_blank"></a></li>
            <li class="list-inline-item text-muted">|</li>
          </ul>
        </div>
		
		
		
		
        <div class="col-sm-8">
		<ul class="list-inline">
		  <li class="list-inline-item"><a style="color:white" href="http://localhost:8000/categories.html">Categories</a></li>
		  <li class="list-inline-item text-muted">|</li>
			<li class="list-inline-item"><a style="color:white" href="http://localhost:8000/tags.html">Tags</a></li>
			<li class="list-inline-item text-muted">|</li>
          <li class="list-inline-item"><a style="color:white" href="http://localhost:8000/archives.html">Archives</a></li>
		  <li class="list-inline-item text-muted">|</li>
			<li class="list-inline-item"><a style="color:white" href="http://localhost:8000/authors.html">Authors</a></li>
          </ul>
        </div>
		
      </div>
    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>NumericalStats: Markov Chain Monte Carlo in 2 dimensions
</h1>
      <hr>
<article class="article">
  <header>
    <ul class="list-inline">
      <li class="list-inline-item text-muted" title="2018-04-30T17:45:00+02:00">
        <i class="fa fa-clock-o"></i>
        Mo. 30 April 2018
      </li>
      <li class="list-inline-item">
        <i class="fa fa-folder-open-o"></i>
        <a href="http://localhost:8000/category/metaanalysis.html">MetaAnalysis</a>
      </li>
      <li class="list-inline-item">
        <i class="fa fa-user-o"></i>
        <a href="http://localhost:8000/author/peter-schuhmacher.html">Peter Schuhmacher</a>      </li>
      <li class="list-inline-item">
        <i class="fa fa-files-o"></i>
        <a href="http://localhost:8000/tag/numerical.html">#numerical</a>,         <a href="http://localhost:8000/tag/statistics.html">#statistics</a>,         <a href="http://localhost:8000/tag/stochastic.html">#stochastic</a>      </li>
    </ul>
  </header>
  <div class="content">
    <p><strong>Stochastic modeling</strong> is a commonly used methodology in health economics and outcomes research (HEOR) with two main purposes: (1) to assess and predict the level of confidence in a chosen course of action and (2) to estimate the value of collecting additional data to better inform the decision.</p>
<p>We will consider a <strong>health related topic</strong>, the distribution of pollutants, to give some insight in the <strong>Markov Chain Monte Carlo modelling</strong> approach. Note that this concept can be transferd to the <strong>analysis of longitudinal studies</strong>.</p>
<p>A <strong>Brownian motion</strong> is a well known prototype of a stochastic process X, physically in a micro scale. Instead of solving the transport equation in the Eulerean coordinate system, given by the differntial equation for the concentration C of the pollutant:</p>
<div class="math">$$
\frac{\partial{C}} {\partial{t}} = \mathbf{u} \nabla C + \nabla (K\nabla C)
$$</div>
<p>the <strong>Wiener process</strong> adresses the position X of one particel or molecule that changes with each time step dt. The change of position dX is given as:
</p>
<div class="math">$$
dX(t) = µdt + σdW(t),
$$</div>
<p>
with</p>
<ul>
<li>change of X is dX</li>
<li>drift parameter µ</li>
<li>variance parameter <span class="math">\(σ^2\)</span></li>
<li>standard Brownian motion W</li>
</ul>
<p>Note that the structure of this equation is:
</p>
<div class="math">$$
\textrm{Total drift} = \textrm{mean drift} + \textrm{random drift}
$$</div>
<p>There are other notations for the same concept:</p>
<ul>
<li>the mean drift parameter µ can be replaced by the mean veloctiy vector $\bar{\mathbf{u}} $</li>
<li>the variance parameter <span class="math">\(σ^2\)</span> times standard Brownian motion W can be replace by the deviation vector of the mean vector <span class="math">\( \acute{\mathbf{u}}\)</span></li>
</ul>
<p>So we will get the following notation for the same concept describing the walk of a particle along the positions <span class="math">\( \mathbf{x}^n\)</span> in a <strong>turbulent flow</strong> in Lagrangian coordinates:</p>
<div class="math">$$\begin{array}{lll}
\mathbf{u}  &amp; = &amp;  \bar{\mathbf{u}} + \acute{\mathbf{u}}\\
d\mathbf{x} &amp; = &amp;   \bar{\mathbf{u}}  \cdot \Delta t + \acute{\mathbf{u}} \cdot \Delta t\\
\mathbf{x}^{n+1}  &amp; = &amp;  \mathbf{x}^{n} + d\mathbf{x}\\
\end{array}
$$</div>
<p>We will apply this concept on the distribution of pollutants. We will recognize that:</p>
<ul>
<li>the example is <strong>fully 2-dimensional</strong></li>
<li>the approach is able to handle <strong>inhomogenoues</strong> conditions for mean drift <span class="math">\(\bar{\mathbf{u}}\)</span> and random deviation <span class="math">\(\acute{\mathbf{u}}\)</span></li>
<li>the final pollutant distribution is allowed to be fairly <strong>complex</strong></li>
<li>the approach is of <strong>Markov</strong> type, because there is a memoryless change of state which depend on the present state only</li>
<li>the approach is of <strong>Monte Carlo</strong> type, because it is random driven to find the solution</li>
<li>the approach is of <strong>Metropolis-Hasting</strong> type, because the sequence of the positions to be visited  are probability controlled</li>
</ul>
<h1>The approaches</h1>
<p>Even at this point, there are still different approaches to find the solution.</p>
<p>The statistician's way is:</p>
<ul>
<li>describe the distribution first</li>
<li>if inevitable include some physical  principles</li>
</ul>
<p>The physicist's way is:</p>
<ul>
<li>model the physical processes first</li>
<li>if inevitable include some statistical principles</li>
</ul>
<p>In the following example we will have a look at the <strong>distribution of pollutants</strong>. 
I think for this strongly inhomogeneous problem the physicist's way is easier to follow and to implement.</p>
<h3>The statistician's language and algorithms</h3>
<ol>
<li>I want to sample from the probability distribution of a pollutant. With enough samples I get the concentration distribution of the pollutant.</li>
<li>But the probability distribution of a pollutant is extremly complex: <ul>
<li>it is 2- or 3-dimensional, </li>
<li>the mean drift is drifting itself</li>
<li>direct sampling from the distribution is not possible</li>
<li>analytical calculations of the distribution is not possible</li>
</ul>
</li>
<li>So let's use a Markov Chain Monte Carlo model<ul>
<li>construct a Markov Chain that - when applied many times on an initial probability distribution - will result in an stationary probability distribution.</li>
<li>after the first few hundreds iterations, each intermediate result is a sample from the stationary probability distribution</li>
<li>estimate interesting quantities about the stationary probability distribution</li>
</ul>
</li>
<li>There is still a question: how do I construct such a Markov Chain ?<ul>
<li>A general and easy construction strategy to find the Markov Chain  is available → the Metropolis–Hastings algorithm</li>
<li>The Markov matrix with the transition probabilities will not be built explicitly. With the numerical algorithm the resulting Markov chain is reproduced localy.</li>
<li>The Metropolis–Hastings algorithm visits the points in the solution space, that have a higher probability to be important.</li>
</ul>
</li>
</ol>
<h3>The physicist's language and algorithms</h3>
<ol>
<li>I want to know the concentration distribution of the pollutant.</li>
<li>It seems to be too difficult to find a solution by an analytical formula</li>
<li>So let's model numerically the processes step by step:<ul>
<li>let's model the mean drift. The generic model might be the Navier-Stokes equations.</li>
<li>let's define a generic model of the random component, driven by a random number generator (= <strong>Monte Carlo</strong> process)</li>
<li>let's assign a passiv tracer particel as a sample. Let's follow this sample trough the solution space (= <strong>Markov</strong> process).</li>
<li>repeat this sample experiment many times and draw the conclusions by doing the statistics about.</li>
</ul>
</li>
<li>The sample particles visits the points, that have a higher probability to be important - that is: they follow the current of the wind are the water (Sounds somehow reasonable, doesn't it ?)</li>
</ol>
<h1>Example 1: Distribution in inhomogeneous conditions</h1>
<p>We generate the mean drift data as an inhomogeneous flow field. It might be a water current in a river bed or an air flow in a valley. Usually fluid dynamics are modelled by the Navier Stokes equations. For sake of brevity we have generated the flow field by some analytical formula.</p>
<p>The random component represents the turbulence which is superimposed to the mean flow. Also for sake of brevity we simulate the turbulence by a singel constant value (standard deviation). So in the following example the turbulence field is homogeneous.</p>
<p>In this first example turbulence is small. We see a pattern as it can be expected from an air flow in cold nocturnal conditions.</p>
<div class="highlight"><pre><span></span><span class="c1">#------ main: Mean Drift ----------        </span>
<span class="n">nx</span><span class="p">,</span><span class="n">ny</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span> <span class="o">=</span> <span class="n">get_grid</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">)</span>
<span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">get_flowfield</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="s1">'C'</span><span class="p">)</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="c1">#------ main: Random Walk ----------   </span>
<span class="n">nTraj</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">sigma</span>  <span class="o">=</span> <span class="mi">80</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span>  <span class="mf">0.6</span>
<span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">,</span><span class="n">C</span> <span class="o">=</span> <span class="n">run_randomWalk</span><span class="p">(</span><span class="n">nTraj</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span> 
<span class="n">plot_distribution</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">,</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>
</pre></div>
<p><img alt="png" class="img-fluid" src="http://localhost:8000/posts/img5201/output_8_0.png"/></p>
<h1>Example 2 : Distribution on a convective summer day</h1>
<p>On a warm summer day turbulence is enhanced. The random component is now much more important relative to the same mean drift as in example 1. The sample particle gets each time step onto a different path of the mean drift.</p>
<div class="highlight"><pre><span></span><span class="c1">#------ main: Random Walk ----------   </span>
<span class="n">nTraj</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">sigma</span>  <span class="o">=</span> <span class="mi">80</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span>  <span class="mf">2.5</span>
<span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">,</span><span class="n">C</span> <span class="o">=</span> <span class="n">run_randomWalk</span><span class="p">(</span><span class="n">nTraj</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span> 
<span class="n">plot_distribution</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">,</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>
</pre></div>
<p><img alt="png" class="img-fluid" src="http://localhost:8000/posts/img5201/output_10_0.png"/></p>
<h1><em>Python code</em></h1>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_grid</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="n">nx</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="n">ny</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># X = ix.T * ones(iy)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># Y = ones(ix) * iy.T</span>
    <span class="n">xc</span> <span class="o">=</span> <span class="n">X</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">yc</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span>

<span class="k">def</span> <span class="nf">get_flowfield</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">case</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">case</span> <span class="o">==</span> <span class="s1">'A'</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span>
    <span class="k">if</span> <span class="n">case</span> <span class="o">==</span> <span class="s1">'C'</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span>  <span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">X</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> <span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="n">y</span> <span class="o">=</span>  <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">Y</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
        <span class="n">u</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">inField</span><span class="p">(</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">if</span> <span class="n">jx</span><span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="bp">False</span><span class="p">;</span> 
    <span class="k">if</span> <span class="n">jx</span><span class="o">&gt;</span><span class="n">nx</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="bp">False</span>
    <span class="k">if</span> <span class="n">jy</span><span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="bp">False</span><span class="p">;</span> 
    <span class="k">if</span> <span class="n">jy</span><span class="o">&gt;</span><span class="n">ny</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="bp">False</span>
    <span class="k">return</span> <span class="n">c</span>

<span class="k">def</span> <span class="nf">fem4</span><span class="p">(</span><span class="err">ξ</span><span class="p">,</span><span class="err">ν</span><span class="p">):</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="err">ξ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="err">ν</span><span class="p">);</span> <span class="n">f2</span> <span class="o">=</span> <span class="p">(</span><span class="err">ξ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="err">ν</span><span class="p">)</span>
    <span class="n">f3</span> <span class="o">=</span> <span class="p">(</span><span class="err">ξ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="err">ν</span><span class="p">);</span>     <span class="n">f4</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="err">ξ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="err">ν</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">f3</span><span class="p">,</span><span class="n">f4</span>

<span class="k">def</span> <span class="nf">get_V</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="p">,</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">):</span>
    <span class="err">ξ</span> <span class="o">=</span> <span class="p">(</span><span class="n">xp</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">jx</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">jx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">jx</span><span class="p">])</span>
    <span class="err">ν</span> <span class="o">=</span> <span class="p">(</span><span class="n">yp</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">jy</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">jy</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">jy</span><span class="p">])</span>
    <span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">f3</span><span class="p">,</span><span class="n">f4</span> <span class="o">=</span> <span class="n">fem4</span><span class="p">(</span><span class="err">ξ</span><span class="p">,</span><span class="err">ν</span><span class="p">)</span>
    <span class="n">up</span> <span class="o">=</span> <span class="n">f1</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">+</span> <span class="n">f2</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">jx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">+</span> <span class="n">f3</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">jx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jy</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">f4</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">vp</span> <span class="o">=</span> <span class="n">f1</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">+</span> <span class="n">f2</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">jx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">+</span> <span class="n">f3</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">jx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jy</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">f4</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">up</span><span class="p">,</span><span class="n">vp</span>

<span class="k">def</span> <span class="nf">get_cell</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
    <span class="n">jx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">xp</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">jy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y</span><span class="o">&gt;=</span><span class="n">yp</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span> <span class="n">inField</span><span class="p">(</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">):</span> 
        <span class="n">up</span><span class="p">,</span><span class="n">vp</span> <span class="o">=</span> <span class="n">get_V</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="p">,</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
        <span class="n">C</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">up</span><span class="p">,</span><span class="n">vp</span><span class="p">,</span><span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="p">[],[],</span><span class="bp">False</span>

<span class="k">def</span> <span class="nf">run_randomWalk</span><span class="p">(</span><span class="n">nTraj</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">sigma</span><span class="p">):</span>   
    <span class="n">xts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">yts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span>    
    <span class="k">for</span> <span class="n">iTraj</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nTraj</span><span class="p">):</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>  <span class="n">yp</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>       
        <span class="n">xtr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xp</span><span class="p">])</span>
        <span class="n">ytr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">yp</span><span class="p">])</span>
        <span class="k">while</span> <span class="mi">1</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">up</span><span class="p">,</span><span class="n">vp</span><span class="p">,</span><span class="n">flag</span> <span class="o">=</span> <span class="n">get_cell</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                <span class="n">upp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span> 
                <span class="n">vpp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span> 
                <span class="n">xp</span> <span class="o">=</span> <span class="n">xp</span> <span class="o">+</span> <span class="p">(</span><span class="n">up</span><span class="o">+</span><span class="n">upp</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">;</span>  <span class="n">xtr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xtr</span><span class="p">,</span> <span class="n">xp</span><span class="p">)</span>
                <span class="n">yp</span> <span class="o">=</span> <span class="n">yp</span> <span class="o">+</span> <span class="p">(</span><span class="n">vp</span><span class="o">+</span><span class="n">vpp</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">;</span>  <span class="n">ytr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ytr</span><span class="p">,</span> <span class="n">yp</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">xts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">xts</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">xtr</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">yts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">yts</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ytr</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">,</span><span class="n">C</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xts</span><span class="p">,</span> <span class="n">yts</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
<p><img alt="png" class="img-fluid" src="http://localhost:8000/posts/img5201/output_15_0.png"/></p>
<h1><em>Grafics</em></h1>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_flowfield</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">):</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">'fivethirtyeight'</span><span class="p">):</span> 
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span> 
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">q0</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">92</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">plasma</span><span class="p">)</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'None'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">quiverkey</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">"2 m/s"</span><span class="p">,</span><span class="n">coordinates</span><span class="o">=</span><span class="s1">'data'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'r'</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_trajectory</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">xtr</span><span class="p">,</span><span class="n">ytr</span><span class="p">):</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">'fivethirtyeight'</span><span class="p">):</span> 
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span> 
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">q0</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">92</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">plasma</span><span class="p">)</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'None'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">quiverkey</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">"2 m/s"</span><span class="p">,</span><span class="n">coordinates</span><span class="o">=</span><span class="s1">'data'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'r'</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtr</span><span class="p">,</span><span class="n">ytr</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">'-'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.65</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Markov Chain Monte Carlo'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_distribution</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">,</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span><span class="n">C</span><span class="p">):</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">'fivethirtyeight'</span><span class="p">):</span> 
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">22</span><span class="p">))</span> 

        <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
        <span class="n">q0</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">92</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">plasma</span><span class="p">)</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'None'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">quiverkey</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">"2 m/s"</span><span class="p">,</span><span class="n">coordinates</span><span class="o">=</span><span class="s1">'data'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'r'</span><span class="p">)</span>        
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">,</span><span class="s1">'-k'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Markov Chain Monte Carlo Random Walk'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">)</span>

        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
        <span class="n">q0</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">92</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">plasma</span><span class="p">)</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'None'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">quiverkey</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">"2 m/s"</span><span class="p">,</span><span class="n">coordinates</span><span class="o">=</span><span class="s1">'data'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'r'</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span> <span class="n">C</span> <span class="p">,</span>  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Probability density distribution ( = concentration)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">)</span>
</pre></div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div>
</article>
<hr>
<div id="disqus_thread"></div>
<script>
  var disqus_config = function() {
    this.page.url = 'http://localhost:8000/posts/two-dimensional-markov-chain_monte-carlo-python.html';
    this.page.identifier = 'two-dimensional-markov-chain_monte-carlo-python';
  };
  (function() {
    var d = document;
    var s = d.createElement('script');
    s.src = '//healthynumerics.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript class="text-muted">
  Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
      <div class="row">
       <ul class="col-sm-6 list-inline">
	      <li class="list-inline-item"><a href="http://localhost:8000/categories.html">Categories</a></li>
			<li class="list-inline-item"><a href="http://localhost:8000/tags.html">Tags</a></li>
          <li class="list-inline-item"><a href="http://localhost:8000/archives.html">Archives</a></li>
			<li class="list-inline-item"><a href="http://localhost:8000/authors.html">Authors</a></li>
        </ul>	
        <p style="color:#C0C0C0;"> 
		    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a> 
		    based on the <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">alchemy &#x2728;</a> theme
           </p>
      </div>
    </div>
  </footer>
</body>

</html>